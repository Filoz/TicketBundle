parameters:
    hackzilla_ticket.user_load.class: Hackzilla\Bundle\TicketBundle\EventListener\UserLoad
    hackzilla_ticket.twig_user.class: Hackzilla\Bundle\TicketBundle\Extension\UserExtension
    hackzilla_ticket.ticket_manager.class: Hackzilla\Bundle\TicketBundle\Manager\TicketManager
    hackzilla_ticket.user_bridge.class: Hackzilla\Bundle\TicketBundle\User\FOSUser

services:
    hackzilla_ticket.listener:
        class: %hackzilla_ticket.user_load.class%
        calls:
            - [setUserManager, ["@hackzilla_ticket.user"]]
        tags:
            - { name: doctrine.event_listener, event: postLoad }

    hackzilla_ticket_user_extension:
        class: %hackzilla_ticket.twig_user.class%
        calls:
            - [setUserManager, ["@hackzilla_ticket.user"]]
        tags:
            - { name: twig.extension }

    hackzilla_ticket.user:
        class: %hackzilla_ticket.user_bridge.class%
        calls:
            - [setUserManager, ["@fos_user.user_manager"]]
            - [setSecurityToken, ["@security.token_storage"]]
            - [setSecurityChecker, ["@security.authorization_checker"]]

    hackzilla_ticket.ticket_manager:
        class: %hackzilla_ticket.ticket_manager.class%
        arguments: ["@doctrine.orm.entity_manager"]
